

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>3HFood API</title>

    <link href="https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css" media="screen" rel="stylesheet">
    <link href="slate/css/print.css" media="print" rel="stylesheet">
    <link href="slate/css/screen.css" media="screen" rel="stylesheet">
    <script src="slate/js/lib/jquery.min.js"></script>
    <script src="slate/js/lib/jquery.highlight.js"></script>
    <script src="slate/js/lib/energize.js"></script>
    <script src="slate/js/lib/imagesloaded.min.js"></script>
    <script src="slate/js/lib/lunr.min.js"></script>
    <script src="slate/js/app/lang.js"></script>
    <script src="slate/js/app/toc.js"></script>
    
    <script src="slate/js/app/search.js"></script>
    
    
    <script src="slate/js/app/copy.js"></script>
    
    <script type="text/javascript">
      function adjustLanguageSelectorWidth() {
        const elem = $('.dark-box > .lang-selector');
        elem.width(elem.parent().width());
      }
      $(function() {
        loadToc($('#toc'), '.toc-link', '.toc-list-h2, .toc-list-h3, .toc-list-h4, .toc-list-h5, .toc-list-h6', 10);
        setupLanguages($('body').data('languages'));
        $('.content').imagesLoaded( function() {
          recacheHeights();
          refreshToc();
        });
        $(window).resize(function() {
          adjustLanguageSelectorWidth();
        });
        adjustLanguageSelectorWidth();
      });
      window.onpopstate = function() {
        activateLanguage(getLanguageFromQueryString());
      };
    </script>
    <!-- slate; content for the head element from source/includes/head.ejs -->
<meta name="theme-color" content="#F3F7F9">

  </head>

  <body data-languages="[&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="slate/img/navbar.png" alt="Navigation">
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="slate/img/logo.png" alt="Logo" class="logo">
      
        <div class="lang-selector">
          
            
              <a href="#" data-language-name="javascript">javascript</a>
            
          
        </div>
      
      
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      

      
        
      
        
      
        
      
        
      
        
      
        
      

      <div id="toc" class="toc-list-h1">
	  	<ul class="toc-list-h1">
        
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
            
          </li>
        
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
            
          </li>
        
          <li>
            <a href="#common---back-office" class="toc-h1 toc-link" data-title="COMMON - Back Office">COMMON - Back Office</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#check-user-exists-%26-can-access-bo" class="toc-h2 toc-link" data-title="">Check user exists &amp; can access BO</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-user-details" class="toc-h2 toc-link" data-title="">Get user details</a>
                    
                  </li>
                
                  <li>
                    <a href="#register-client" class="toc-h2 toc-link" data-title="">Register client</a>
                    
                  </li>
                
                  <li>
                    <a href="#register-supermarket" class="toc-h2 toc-link" data-title="">Register Supermarket</a>
                    
                  </li>
                
                  <li>
                    <a href="#register-cashier" class="toc-h2 toc-link" data-title="">Register Cashier</a>
                    
                  </li>
                
                  <li>
                    <a href="#register-privilegied-user" class="toc-h2 toc-link" data-title="">Register Privilegied User</a>
                    
                  </li>
                
                  <li>
                    <a href="#set-password-reset" class="toc-h2 toc-link" data-title="">Set password reset</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
          <li>
            <a href="#wholesaler" class="toc-h1 toc-link" data-title="Wholesaler">Wholesaler</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#create-product" class="toc-h2 toc-link" data-title="">Create product</a>
                    
                  </li>
                
                  <li>
                    <a href="#update-product" class="toc-h2 toc-link" data-title="">Update product</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-product-detail" class="toc-h2 toc-link" data-title="">Get product detail</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-products-dashboard" class="toc-h2 toc-link" data-title="">Get products dashboard</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-products" class="toc-h2 toc-link" data-title="">Get products</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-peremption-dashboard" class="toc-h2 toc-link" data-title="">Get peremption dashboard</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-perishments" class="toc-h2 toc-link" data-title="">Get perishments</a>
                    
                  </li>
                
                  <li>
                    <a href="#delete-perishments-for-product" class="toc-h2 toc-link" data-title="">Delete perishments for product</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-dashboard" class="toc-h2 toc-link" data-title="">Get dashboard</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-tracker" class="toc-h2 toc-link" data-title="">Get tracker</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-tracker-detail" class="toc-h2 toc-link" data-title="">Get tracker detail</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-professionnal-orders-dashboard" class="toc-h2 toc-link" data-title="">Get professionnal orders dashboard</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-orders-by-filter" class="toc-h2 toc-link" data-title="">Get orders by filter</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
          <li>
            <a href="#supermarket" class="toc-h1 toc-link" data-title="Supermarket">Supermarket</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#check-if-onboarding-complete" class="toc-h2 toc-link" data-title="">Check if onboarding complete</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-all-wholesalers" class="toc-h2 toc-link" data-title="">Get all wholesalers</a>
                    
                  </li>
                
                  <li>
                    <a href="#create-professional-order" class="toc-h2 toc-link" data-title="">Create professional order</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-professional-orders" class="toc-h2 toc-link" data-title="">Get professional orders</a>
                    
                  </li>
                
                  <li>
                    <a href="#set-order-as-delivered" class="toc-h2 toc-link" data-title="">Set order as delivered</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-warehouse-stock-dashboard" class="toc-h2 toc-link" data-title="">Get warehouse stock dashboard</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-warehouse-storage" class="toc-h2 toc-link" data-title="">Get Warehouse storage</a>
                    
                  </li>
                
                  <li>
                    <a href="#set-storage-alley" class="toc-h2 toc-link" data-title="">Set storage alley</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-product-details" class="toc-h2 toc-link" data-title="">Get Product Details</a>
                    
                  </li>
                
                  <li>
                    <a href="#update-product" class="toc-h2 toc-link" data-title="">Update product</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-client-stock-detail" class="toc-h2 toc-link" data-title="">Get Client Stock Detail</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-client-stock" class="toc-h2 toc-link" data-title="">Get Client Stock</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-perishment-dashboard" class="toc-h2 toc-link" data-title="">Get perishment dashboard</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-perishment" class="toc-h2 toc-link" data-title="">Get perishment</a>
                    
                  </li>
                
                  <li>
                    <a href="#delete-perished-stock" class="toc-h2 toc-link" data-title="">Delete perished stock</a>
                    
                  </li>
                
                  <li>
                    <a href="#create-discount" class="toc-h2 toc-link" data-title="">Create discount</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-discount-dashboard" class="toc-h2 toc-link" data-title="">Get discount dashboard</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-discount" class="toc-h2 toc-link" data-title="">Get discount</a>
                    
                  </li>
                
                  <li>
                    <a href="#update-discount" class="toc-h2 toc-link" data-title="">Update discount</a>
                    
                  </li>
                
                  <li>
                    <a href="#delete-discount" class="toc-h2 toc-link" data-title="">Delete discount</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-reviews" class="toc-h2 toc-link" data-title="">Get reviews</a>
                    
                  </li>
                
                  <li>
                    <a href="#get-product-price" class="toc-h2 toc-link" data-title="">Get product price</a>
                    
                  </li>
                
                  <li>
                    <a href="#set-product-price" class="toc-h2 toc-link" data-title="">Set product price</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
          <li>
            <a href="#search" class="toc-h1 toc-link" data-title="Search">Search</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#search-in-wholesaler-products" class="toc-h2 toc-link" data-title="">Search in wholesaler products</a>
                    
                  </li>
                
                  <li>
                    <a href="#search-in-categories-(common)" class="toc-h2 toc-link" data-title="">Search in categories (COMMON)</a>
                    
                  </li>
                
                  <li>
                    <a href="#search-tracker-line" class="toc-h2 toc-link" data-title="">Search tracker line</a>
                    
                  </li>
                
                  <li>
                    <a href="#search-tracker-details" class="toc-h2 toc-link" data-title="">Search tracker details</a>
                    
                  </li>
                
                  <li>
                    <a href="#search-wholesaler-orders" class="toc-h2 toc-link" data-title="">Search wholesaler orders</a>
                    
                  </li>
                
                  <li>
                    <a href="#search-wholesaler-perishments" class="toc-h2 toc-link" data-title="">Search wholesaler perishments</a>
                    
                  </li>
                
                  <li>
                    <a href="#search-supermarket-orders" class="toc-h2 toc-link" data-title="">Search supermarket orders</a>
                    
                  </li>
                
                  <li>
                    <a href="#search-product-for-supermarket-new-order" class="toc-h2 toc-link" data-title="">Search product for supermarket new order</a>
                    
                  </li>
                
                  <li>
                    <a href="#search-product-for-supermarket-other-screens" class="toc-h2 toc-link" data-title="">Search product for supermarket other screens</a>
                    
                  </li>
                
                  <li>
                    <a href="#search-supermarket-warehouse-stock" class="toc-h2 toc-link" data-title="">Search supermarket warehouse stock</a>
                    
                  </li>
                
                  <li>
                    <a href="#search-supermarket-client-stock" class="toc-h2 toc-link" data-title="">Search supermarket client stock</a>
                    
                  </li>
                
                  <li>
                    <a href="#search-supermarket-perishments" class="toc-h2 toc-link" data-title="">Search supermarket perishments</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
            
          </li>
        
          <li>
            <a href="#client---cart" class="toc-h1 toc-link" data-title="Client - Cart">Client - Cart</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#create-cart" class="toc-h2 toc-link" data-title="">Create cart</a>
                    
                  </li>
                
                  <li>
                    <a href="#add-product-to-cart" class="toc-h2 toc-link" data-title="">Add product to cart</a>
                    
                  </li>
                
                  <li>
                    <a href="#remove-product-from-cart" class="toc-h2 toc-link" data-title="">Remove product from cart</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
		</ul>
      </div>
      
        <ul class="toc-footer">
          
            <li><a href='https://github.com/slatedocs/slate'>Documentation Powered by Slate</a></li>
          
        </ul>
      
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>
<p>L’API 3Hfood est une api unique pour tous les endpoints de toutes les applications 3HFood.</p>
<p>Le tout est hébergé sur des cloud function, les fonctions sont alors à appeler par le biais du package firebase dans l’application</p>
<h1 id="authentication">Authentication</h1>
<p>Toutes les routes (sauf login) ont besoin d’une authentification pour foncionner. Le package firebase se charge tout seul du renew de token, et de passer le token dans la requête.</p>
<h1 id="common---back-office">COMMON - Back Office</h1>
<h2 id="check-user-exists-%26-can-access-bo">Check user exists &amp; can access BO</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'common-userExistsForBackOffice'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  email<span class="token operator">:</span> <span class="token string">"florent.huran@outlook.fr"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"continueLogin"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"shouldRenewPassword"</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint checks if user exists and can access the BO.</p>
<h3 id="http-request">HTTP Request</h3>
<p><code>GET common-userExistsForBackOffice</code></p>
<h3 id="query-parameters">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Email</td>
<td>false</td>
<td>Email the user entered on the field</td>
</tr>
</tbody>
</table>
<h2 id="get-user-details">Get user details</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'common-getUser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"user"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"WHOLESALER"</span><span class="token punctuation">,</span>
            <span class="token property">"first_name"</span><span class="token operator">:</span> <span class="token string">"Florent"</span><span class="token punctuation">,</span>
            <span class="token property">"last_name"</span><span class="token operator">:</span> <span class="token string">"Huran"</span><span class="token punctuation">,</span>
            <span class="token property">"email"</span><span class="token operator">:</span> <span class="token string">"florent.huran@outlook.fr"</span><span class="token punctuation">,</span>
            <span class="token property">"must_renew_password"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">"phone"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"address"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"zipcode"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"city"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"carbon_footprint"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"iban"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"bic"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"stripe_customer_id"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"stripe_mandate_id"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
            <span class="token property">"current_cart_uuid"</span><span class="token operator">:</span> <span class="token null keyword">null</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint checks user details if authenticated in firebase.</p>
<h3 id="http-request-1">HTTP Request</h3>
<p><code>GET common-getUser</code></p>
<h3 id="query-parameters-1">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="register-client">Register client</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'common-createClient'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
		firstName<span class="token operator">:</span> <span class="token string">"Kamil"</span><span class="token punctuation">,</span>
    lastName<span class="token operator">:</span> <span class="token string">"Hammouche"</span><span class="token punctuation">,</span>
    phone<span class="token operator">:</span> <span class="token string">"0612345678"</span><span class="token punctuation">,</span>
    address<span class="token operator">:</span> <span class="token string">"25 rue Nationale"</span><span class="token punctuation">,</span>
    zipcode<span class="token operator">:</span> <span class="token string">"59000"</span><span class="token punctuation">,</span>
    city<span class="token operator">:</span> <span class="token string">"Lille"</span><span class="token punctuation">,</span>
  	iban<span class="token operator">:</span> <span class="token string">"DE89370400440532013000"</span><span class="token punctuation">,</span>
  	bic<span class="token operator">:</span> <span class="token string">"CMCIFR2A"</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"success"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>First register user in firebase, then make the call with the firebase user so the API can retrieve his email, otherwise the call will crash.</p>
<p>This endpoint will create user in database, on stripe, create a payment method on stripe linked to the generated customer id, and create a SetupIntent for future payments of the client.</p>
<p>The BIC is only for information purpose, not taken into consideration by Stripe.</p>
<h3 id="http-request-2">HTTP Request</h3>
<p><code>GET common-createClient</code></p>
<h3 id="query-parameters-2">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>firstName</td>
<td>String</td>
<td>First name of user</td>
</tr>
<tr>
<td>lastName</td>
<td>String</td>
<td>Last name of user</td>
</tr>
<tr>
<td>phone</td>
<td>String</td>
<td>Phone of user</td>
</tr>
<tr>
<td>address</td>
<td>String</td>
<td>Address of user</td>
</tr>
<tr>
<td>zipcode</td>
<td>String</td>
<td>Zipcode of user - 5 chars max</td>
</tr>
<tr>
<td>iban</td>
<td>String</td>
<td>IBAN of the account to perform debits on</td>
</tr>
</tbody>
</table>
<h2 id="register-supermarket">Register Supermarket</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'common-createSupermarket'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    firstName<span class="token operator">:</span> <span class="token string">"Kamil"</span><span class="token punctuation">,</span>
    lastName<span class="token operator">:</span> <span class="token string">"Hammouche"</span><span class="token punctuation">,</span>
    phone<span class="token operator">:</span> <span class="token string">"0612345678"</span><span class="token punctuation">,</span>
    address<span class="token operator">:</span> <span class="token string">"25 rue Nationale"</span><span class="token punctuation">,</span>
    zipcode<span class="token operator">:</span> <span class="token string">"59000"</span><span class="token punctuation">,</span>
    city<span class="token operator">:</span> <span class="token string">"Lille"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"success"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint takes all the parameters from registration to create a supermarket in db and on stripe side.</p>
<p>The email is fetched from the firebase auth token sent with the request.</p>
<h3 id="http-request-3">HTTP Request</h3>
<p><code>GET common-createSupermarket</code></p>
<h3 id="query-parameters-3">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>firstName</td>
<td>String</td>
<td>First name of user</td>
</tr>
<tr>
<td>lastName</td>
<td>String</td>
<td>Last name of user</td>
</tr>
<tr>
<td>phone</td>
<td>String</td>
<td>Phone of user</td>
</tr>
<tr>
<td>address</td>
<td>String</td>
<td>Address of user</td>
</tr>
<tr>
<td>zipcode</td>
<td>String</td>
<td>Zipcode of user - 5 chars max</td>
</tr>
<tr>
<td>city</td>
<td>String</td>
<td>City of user</td>
</tr>
</tbody>
</table>
<h2 id="register-cashier">Register Cashier</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'common-createCashier'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    supermarketEmail<span class="token operator">:</span> <span class="token string">"seclin@3hfood.fr"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"success"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint takes all the parameters from registration and create the cashier user in db, and link it to the given supermarket.</p>
<h3 id="http-request-4">HTTP Request</h3>
<p><code>GET common-createCashier</code></p>
<h3 id="query-parameters-4">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>supermarketEmail</td>
<td>String</td>
<td>Email of the supermarket to link the cashier to</td>
</tr>
</tbody>
</table>
<h2 id="register-privilegied-user">Register Privilegied User</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'common-createElevatedUser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">"SUPERMARKET"</span><span class="token punctuation">,</span>
    firstName<span class="token operator">:</span> <span class="token string">"Kamil"</span><span class="token punctuation">,</span>
    lastName<span class="token operator">:</span> <span class="token string">"Hammouche"</span><span class="token punctuation">,</span>
    phone<span class="token operator">:</span> <span class="token string">"0612345678"</span><span class="token punctuation">,</span>
    address<span class="token operator">:</span> <span class="token string">"25 rue Nationale"</span><span class="token punctuation">,</span>
    zipcode<span class="token operator">:</span> <span class="token string">"59000"</span><span class="token punctuation">,</span>
    city<span class="token operator">:</span> <span class="token string">"Lille"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"success"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint takes all the parameters from registration and create the user object in database</p>
<h3 id="http-request-5">HTTP Request</h3>
<p><code>GET common-createClient</code></p>
<h3 id="query-parameters-5">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>firstName</td>
<td>String</td>
<td>First name of user</td>
</tr>
<tr>
<td>lastName</td>
<td>String</td>
<td>Last name of user</td>
</tr>
<tr>
<td>phone</td>
<td>String</td>
<td>Phone of user</td>
</tr>
<tr>
<td>address</td>
<td>String</td>
<td>Address of user</td>
</tr>
<tr>
<td>zipcode</td>
<td>String</td>
<td>Zipcode of user - 5 chars max</td>
</tr>
<tr>
<td>city</td>
<td>String</td>
<td>City of user</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>User type in: WHOLESALER - TAGMANAGER - STOCKMANAGER - SUPERADMIN</td>
</tr>
</tbody>
</table>
<h2 id="set-password-reset">Set password reset</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'common-hasResetPassword'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
       <span class="token property">"success"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint set the flag ‘needs password reset’ to false. To be called when the user has reset his password and is well authenticated</p>
<h3 id="http-request-6">HTTP Request</h3>
<p><code>GET common-hasResetPassword</code></p>
<h3 id="query-parameters-6">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="wholesaler">Wholesaler</h1>
<h2 id="create-product">Create product</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'wholesaler-createProduct'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  product<span class="token operator">:</span> <span class="token punctuation">{</span>
    ean<span class="token operator">:</span> <span class="token string">"1234567890123"</span><span class="token punctuation">,</span>
    imageUrl<span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
    length<span class="token operator">:</span> <span class="token number">12.9</span><span class="token punctuation">,</span>
    width<span class="token operator">:</span> <span class="token number">69.0</span><span class="token punctuation">,</span>
    height<span class="token operator">:</span> <span class="token number">88.0</span><span class="token punctuation">,</span>
    weight<span class="token operator">:</span> <span class="token number">125.7</span><span class="token punctuation">,</span>
    sellingUnit<span class="token operator">:</span> <span class="token string">"12x1L"</span><span class="token punctuation">,</span>
    legalUnitPrice<span class="token operator">:</span> <span class="token string">"1,18€/L"</span><span class="token punctuation">,</span>
    professionnalPrice<span class="token operator">:</span> <span class="token number">2.88</span><span class="token punctuation">,</span>
    vatClass<span class="token operator">:</span> <span class="token number">5.5</span><span class="token punctuation">,</span>
    composition<span class="token operator">:</span> <span class="token string">"Juste de l'air, on vend de l'air"</span><span class="token punctuation">,</span>
    categoryId<span class="token operator">:</span> <span class="token number">2</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  stockMovements <span class="token punctuation">{</span>
    addition<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
				quantity<span class="token operator">:</span> <span class="token number">120</span><span class="token punctuation">,</span>
  			perishDate<span class="token operator">:</span> <span class="token string">"2022-02-20"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    	<span class="token punctuation">{</span>
				quantity<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
  			perishDate<span class="token operator">:</span> <span class="token string">"2022-02-18"</span>
      <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"success"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint creates a new product in database without checking if another EAN is already in base</p>
<h3 id="http-request">HTTP Request</h3>
<p><code>GET wholesaler-createProduct</code></p>
<h3 id="query-parameters">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Child</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>product</td>
<td></td>
<td>Object</td>
<td>A product object as described in the project</td>
</tr>
<tr>
<td></td>
<td>ean</td>
<td>String</td>
<td>EAN code of the product. No verification is done for it to be unique, so for the POC we’ll assume it’ll be ok</td>
</tr>
<tr>
<td></td>
<td>imageUrl</td>
<td>String</td>
<td>Link to the product image</td>
</tr>
<tr>
<td></td>
<td>name</td>
<td>String</td>
<td>Name of the product as shown to final customers</td>
</tr>
<tr>
<td></td>
<td>length</td>
<td>Float</td>
<td>Length of the product (can be useful in the future)</td>
</tr>
<tr>
<td></td>
<td>width</td>
<td>Float</td>
<td>Width of the product (can be useful in the future)</td>
</tr>
<tr>
<td></td>
<td>height</td>
<td>Float</td>
<td>Height of the product (can be useful in the future)</td>
</tr>
<tr>
<td></td>
<td>weight</td>
<td>Float</td>
<td>Weight of the product (can be useful in the future)</td>
</tr>
<tr>
<td></td>
<td>sellingUnit</td>
<td>String</td>
<td>The packaging size of the product. E.g: 12x1L, 200g, 1.5L, 1.5kg</td>
</tr>
<tr>
<td></td>
<td>legalUnitPrice</td>
<td>String</td>
<td>Price pet legal quantity. Eg: 2.00€/kg, 1.13€/L</td>
</tr>
<tr>
<td></td>
<td>professionalPrice</td>
<td>Float</td>
<td>Price as sold to supermarkets</td>
</tr>
<tr>
<td></td>
<td>vatClass</td>
<td>Float</td>
<td>VAT value</td>
</tr>
<tr>
<td></td>
<td>composition</td>
<td>String</td>
<td>Ingredients of the product</td>
</tr>
<tr>
<td></td>
<td>categoryId</td>
<td>Int</td>
<td>Product Category ID</td>
</tr>
<tr>
<td>stockMovements</td>
<td></td>
<td>Object</td>
<td>Map containing all stock movements done client side <strong>- required even if empty</strong></td>
</tr>
<tr>
<td>stockMovements.addition</td>
<td></td>
<td>Array</td>
<td>Array containing all added stock lines stored as objects</td>
</tr>
<tr>
<td></td>
<td>quantity</td>
<td>Int</td>
<td>Quantity on the stock line</td>
</tr>
<tr>
<td></td>
<td>perishDate</td>
<td>Date</td>
<td>Perish date on the stock line, format YYYY-MM-DD</td>
</tr>
</tbody>
</table>
<h2 id="update-product">Update product</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'wholesaler-updateProduct'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  product<span class="token operator">:</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    ean<span class="token operator">:</span> <span class="token string">"1234567890123"</span><span class="token punctuation">,</span>
    imageUrl<span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
    length<span class="token operator">:</span> <span class="token number">12.9</span><span class="token punctuation">,</span>
    width<span class="token operator">:</span> <span class="token number">69.0</span><span class="token punctuation">,</span>
    height<span class="token operator">:</span> <span class="token number">88.0</span><span class="token punctuation">,</span>
    weight<span class="token operator">:</span> <span class="token number">125.7</span><span class="token punctuation">,</span>
    sellingUnit<span class="token operator">:</span> <span class="token string">"12x1L"</span><span class="token punctuation">,</span>
    legalUnitPrice<span class="token operator">:</span> <span class="token string">"1,18€/L"</span><span class="token punctuation">,</span>
    professionnalPrice<span class="token operator">:</span> <span class="token number">2.88</span><span class="token punctuation">,</span>
    vatClass<span class="token operator">:</span> <span class="token number">5.5</span><span class="token punctuation">,</span>
    composition<span class="token operator">:</span> <span class="token string">"Juste de l'air, on vend de l'air"</span><span class="token punctuation">,</span>
    categoryId<span class="token operator">:</span> <span class="token number">2</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  stockMovements <span class="token punctuation">{</span>
    addition<span class="token operator">:</span> <span class="token punctuation">[</span>
  		<span class="token punctuation">{</span>
				quantity<span class="token operator">:</span> <span class="token number">120</span><span class="token punctuation">,</span>
  			perishDate<span class="token operator">:</span> <span class="token string">"2022-02-20"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    	<span class="token punctuation">{</span>
				quantity<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
  			perishDate<span class="token operator">:</span> <span class="token string">"2022-02-18"</span>
      <span class="token punctuation">}</span>
		<span class="token punctuation">]</span><span class="token punctuation">,</span>
    changes<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        id<span class="token operator">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
        quantity<span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
        perishDate<span class="token operator">:</span> <span class="token string">"2022-02-18"</span>
   		<span class="token punctuation">}</span><span class="token punctuation">,</span> 
     	<span class="token punctuation">{</span>
        id<span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
        quantity<span class="token operator">:</span> <span class="token number">155</span><span class="token punctuation">,</span>
        perishDate<span class="token operator">:</span> <span class="token string">"2022-02-18"</span>
    	<span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    deletions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"success"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint creates a new product in database without checking if another EAN is already in base</p>
<h3 id="important">Important</h3>
<p>Si une erreur est renvoyée de cet appel, et que cette erreur n’est pas une erreur INVALID_ARGUMENT, alors il y a eu un problème côté DB mais une partie des modifications ont été sauvegardées. On</p>
<p>If this call raises an error not of type INVALID_ARGUMENT, it means there was a problem on the database side (most probably a stok modification on a stock line that no longer exists), but some product info had been saved anyway, so please <strong>force refresh the page</strong></p>
<h3 id="http-request-1">HTTP Request</h3>
<p><code>GET wholesaler-updateProduct</code></p>
<h3 id="query-parameters-1">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Child</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>product</td>
<td></td>
<td>Object</td>
<td>A product object as described in the project</td>
</tr>
<tr>
<td></td>
<td>ean</td>
<td>String</td>
<td>EAN code of the product. No verification is done for it to be unique, so for the POC we’ll assume it’ll be ok</td>
</tr>
<tr>
<td></td>
<td>imageUrl</td>
<td>String</td>
<td>Link to the product image</td>
</tr>
<tr>
<td></td>
<td>name</td>
<td>String</td>
<td>Name of the product as shown to final customers</td>
</tr>
<tr>
<td></td>
<td>length</td>
<td>Float</td>
<td>Length of the product (can be useful in the future)</td>
</tr>
<tr>
<td></td>
<td>width</td>
<td>Float</td>
<td>Width of the product (can be useful in the future)</td>
</tr>
<tr>
<td></td>
<td>height</td>
<td>Float</td>
<td>Height of the product (can be useful in the future)</td>
</tr>
<tr>
<td></td>
<td>weight</td>
<td>Float</td>
<td>Weight of the product (can be useful in the future)</td>
</tr>
<tr>
<td></td>
<td>sellingUnit</td>
<td>String</td>
<td>The packaging size of the product. E.g: 12x1L, 200g, 1.5L, 1.5kg</td>
</tr>
<tr>
<td></td>
<td>legalUnitPrice</td>
<td>String</td>
<td>Price pet legal quantity. Eg: 2.00€/kg, 1.13€/L</td>
</tr>
<tr>
<td></td>
<td>professionalPrice</td>
<td>Float</td>
<td>Price as sold to supermarkets</td>
</tr>
<tr>
<td></td>
<td>vatClass</td>
<td>Float</td>
<td>VAT value</td>
</tr>
<tr>
<td></td>
<td>composition</td>
<td>String</td>
<td>Ingredients of the product</td>
</tr>
<tr>
<td></td>
<td>categoryId</td>
<td>Int</td>
<td>Product Category ID</td>
</tr>
<tr>
<td>stockMovements</td>
<td></td>
<td>Object</td>
<td>Map containing all stock movements done client side <strong>- required even if empty</strong></td>
</tr>
<tr>
<td>stockMovements.addition</td>
<td></td>
<td>Array</td>
<td>Array containing all added stock lines stored as objects</td>
</tr>
<tr>
<td></td>
<td>quantity</td>
<td>Int</td>
<td>Quantity on the stock line</td>
</tr>
<tr>
<td></td>
<td>perishDate</td>
<td>Date</td>
<td>Perish date on the stock line, format YYYY-MM-DD</td>
</tr>
<tr>
<td>stockMovements.changes</td>
<td></td>
<td>Array</td>
<td>Array containing all edited stock lines stored as objects</td>
</tr>
<tr>
<td></td>
<td>id</td>
<td>Int</td>
<td>Id of edited line</td>
</tr>
<tr>
<td></td>
<td>quantity</td>
<td>Int</td>
<td>New quantity of edited stock line</td>
</tr>
<tr>
<td></td>
<td>perishDate</td>
<td>Date</td>
<td>New perish date on the stock line, format YYYY-MM-DD</td>
</tr>
<tr>
<td>stockMovements.deletions</td>
<td></td>
<td>Array</td>
<td>Array of deleted ids</td>
</tr>
</tbody>
</table>
<h2 id="get-product-detail">Get product detail</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'wholesaler-getProductDetail'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  productId<span class="token operator">:</span> <span class="token number">18</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"product"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
            <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
            <span class="token property">"linked_wholesaler"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
            <span class="token property">"length"</span><span class="token operator">:</span> <span class="token number">53</span><span class="token punctuation">,</span>
            <span class="token property">"width"</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
            <span class="token property">"height"</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
            <span class="token property">"weight"</span><span class="token operator">:</span> <span class="token number">288</span><span class="token punctuation">,</span>
            <span class="token property">"selling_unit"</span><span class="token operator">:</span> <span class="token string">"2x12l"</span><span class="token punctuation">,</span>
            <span class="token property">"legal_unit_price"</span><span class="token operator">:</span> <span class="token string">"1,38€/L"</span><span class="token punctuation">,</span>
            <span class="token property">"professional_price"</span><span class="token operator">:</span> <span class="token number">55.8</span><span class="token punctuation">,</span>
            <span class="token property">"retail_price"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">"vat_class"</span><span class="token operator">:</span> <span class="token number">5.5</span><span class="token punctuation">,</span>
            <span class="token property">"composition"</span><span class="token operator">:</span> <span class="token string">"Juste de l'eau"</span><span class="token punctuation">,</span>
            <span class="token property">"linked_category"</span><span class="token operator">:</span> <span class="token number">4</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"stockLines"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">49</span><span class="token punctuation">,</span>
                <span class="token property">"product_id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
                <span class="token property">"wholesaler_id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">"quantity"</span><span class="token operator">:</span> <span class="token number">9550</span><span class="token punctuation">,</span>
                <span class="token property">"perish_date"</span><span class="token operator">:</span> <span class="token string">"2021-02-28"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint fetches all the product informations as well as all the stock lines ordered from more close to more far away from perishment date.</p>
<h3 id="http-request-2">HTTP Request</h3>
<p><code>GET wholesaler-getProductDetail</code></p>
<h3 id="query-parameters-2">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="get-products-dashboard">Get products dashboard</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'wholesaler-getProductsDashboard'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"products"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
                <span class="token property">"stock_quantity"</span><span class="token operator">:</span> <span class="token number">640</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
                <span class="token property">"stock_quantity"</span><span class="token operator">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"categories"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Tous les produits"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"En rupture"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-1</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Bientôt en rupture"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-2</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Biscuits"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">2</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Cafés"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">4</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint has multiple interesting data inside of it.</p>
<p>It can fetch the first 10 products from the “all products” tab (which is the default one, so thumbs up for that)</p>
<p>It fetches product counts for total count, out of stock, and near out of stock for the side bar.</p>
<p>And it sends back an array of categories with product count and labels for side bar filtering</p>
<h3 id="http-request-3">HTTP Request</h3>
<p><code>GET wholesaler-getProductsDashboard</code></p>
<h3 id="query-parameters-3">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="get-products">Get products</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'wholesaler-getProducts'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  categoryId<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">10</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
            <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
            <span class="token property">"stock_quantity"</span><span class="token operator">:</span> <span class="token number">640</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
            <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
            <span class="token property">"stock_quantity"</span><span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoints allow you to fetch data with an offset and a category or a stock status filter (according to the filters list the api sent you on the previous call);</p>
<p>You’ll get products by bunch of 10.</p>
<h3 id="http-request-4">HTTP Request</h3>
<p><code>GET wholesaler-getProducts</code></p>
<h3 id="query-parameters-4">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>categoryId</td>
<td>Int</td>
<td>The filter category ID (sent in the previous call where you fetched all available filters)</td>
</tr>
<tr>
<td>offset</td>
<td>Int</td>
<td>The offset applied to the request</td>
</tr>
</tbody>
</table>
<h2 id="get-peremption-dashboard">Get peremption dashboard</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'wholesaler-getPerishmentDashboard'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"products"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
                <span class="token property">"perished_quantity"</span><span class="token operator">:</span> <span class="token number">640</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"categories"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Périmés"</span><span class="token punctuation">,</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Périment dans -7 jours"</span><span class="token punctuation">,</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-1</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Périment dans -14 jours"</span><span class="token punctuation">,</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-2</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allow you to fetch the first 10 perished products and fetch the side filters with product count and filter id in order to perform other queries.</p>
<h3 id="http-request-5">HTTP Request</h3>
<p><code>GET wholesaler-getPerishmentDashboard</code></p>
<h3 id="query-parameters-5">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
</table>
<h2 id="get-perishments">Get perishments</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'wholesaler-getPerishments'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  categoryId<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">10</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"products"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
                <span class="token property">"perished_quantity"</span><span class="token operator">:</span> <span class="token number">640</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"categories"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Périmés"</span><span class="token punctuation">,</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Périment dans -7 jours"</span><span class="token punctuation">,</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-1</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Périment dans -14 jours"</span><span class="token punctuation">,</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-2</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch 10 products from a set perishment date, with a given offset. You get the categoryId from the first call from peremptionDashboard</p>
<h3 id="http-request-6">HTTP Request</h3>
<p><code>GET wholesaler-getPerishments</code></p>
<h3 id="query-parameters-6">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>categoryId</td>
<td>Int</td>
<td>The filter category ID (sent in the previous call where you fetched all available filters)</td>
</tr>
<tr>
<td>offset</td>
<td>Int</td>
<td>The offset applied to the request</td>
</tr>
</tbody>
</table>
<h2 id="delete-perishments-for-product">Delete perishments for product</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'wholesaler-deletePerishedStock'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  productId<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"success"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch 10 products from a set perishment date, with a given offset. You get the categoryId from the first call from peremptionDashboard</p>
<h3 id="http-request-7">HTTP Request</h3>
<p><code>GET wholesaler-deletePerishedStock</code></p>
<h3 id="query-parameters-7">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>productId</td>
<td>Int</td>
<td>The product ID from whom delete all perished stock lines</td>
</tr>
</tbody>
</table>
<h2 id="get-dashboard">Get dashboard</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'wholesaler-getDashboard'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"to_prepare"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">"in_delivery"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">"out_of_stock_count"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">"perishment_warnings"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"first_name"</span><span class="token operator">:</span> <span class="token string">"3HFood"</span><span class="token punctuation">,</span>
                <span class="token property">"last_name"</span><span class="token operator">:</span> <span class="token string">"Seclin"</span><span class="token punctuation">,</span>
                <span class="token property">"products_count"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token property">"quantity_count"</span><span class="token operator">:</span> <span class="token number">250</span><span class="token punctuation">,</span>
                <span class="token property">"total_price"</span><span class="token operator">:</span> <span class="token number">10649.999809265137</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch all the data for the wholesaler dashboard</p>
<h3 id="http-request-8">HTTP Request</h3>
<p><code>GET wholesaler-getDashboard</code></p>
<h3 id="query-parameters-8">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
</table>
<h2 id="get-tracker">Get tracker</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'wholesaler-getTracking'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  orderingId<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"tracker_lines"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                <span class="token property">"first_name"</span><span class="token operator">:</span> <span class="token string">"3HFood"</span><span class="token punctuation">,</span>
                <span class="token property">"last_name"</span><span class="token operator">:</span> <span class="token string">"Seclin"</span><span class="token punctuation">,</span>
                <span class="token property">"near_perishment_references_count"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">"perished_products_count"</span><span class="token operator">:</span> <span class="token number">250</span><span class="token punctuation">,</span>
                <span class="token property">"references_count"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token property">"products_count"</span><span class="token operator">:</span> <span class="token number">350</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"total_lines"</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch tracker data to allow the wholesaler to see stock status on every supermarket he delivers.</p>
<p>Without a defined supermarketId, it’ll fetch the 10 first lines (or the 10 lines offseted by the offset value) of the tracker.</p>
<p>With a defined supermarketId, it’ll only fetch this line of the tracker and no other.</p>
<h3 id="http-request-9">HTTP Request</h3>
<p><code>GET wholesaler-getTracking</code></p>
<h3 id="query-parameters-9">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>orderingId</td>
<td>Int</td>
<td>Different values: <strong>0</strong>-Alphabetical order ascending, <strong>1</strong>-Near perishment references count descending, <strong>2</strong>-Perished products count descending</td>
</tr>
<tr>
<td>offset</td>
<td>Int</td>
<td>Offset value applied to the query</td>
</tr>
<tr>
<td>supermarketId</td>
<td>Int?</td>
<td>Optionnal supermarketId filter to only fetch this supermarket in particular. Useful for the search functionnality</td>
</tr>
</tbody>
</table>
<h2 id="get-tracker-detail">Get tracker detail</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'wholesaler-getTrackingDetail'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  supermarketId<span class="token operator">:</span> <span class="token number">4</span>
  orderingId<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"lines"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"product_id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Deuxième produit"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
                <span class="token property">"total_stock"</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
                <span class="token property">"nearest_perish_date"</span><span class="token operator">:</span> <span class="token string">"2021-03-17"</span><span class="token punctuation">,</span>
                <span class="token property">"near_perish_stock"</span><span class="token operator">:</span> <span class="token number">600</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"product_id"</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
                <span class="token property">"total_stock"</span><span class="token operator">:</span> <span class="token number">250</span><span class="token punctuation">,</span>
                <span class="token property">"nearest_perish_date"</span><span class="token operator">:</span> <span class="token string">"2021-03-31"</span><span class="token punctuation">,</span>
                <span class="token property">"near_perish_stock"</span><span class="token operator">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"total_lines"</span><span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch tracker detail for a specified supermarket Id, with ordering and offset.</p>
<h3 id="http-request-10">HTTP Request</h3>
<p><code>GET wholesaler-getTrackingDetail</code></p>
<h3 id="query-parameters-10">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>supermarketId</td>
<td>Int</td>
<td>SupermarketId to fetch the tracker detail lines from.</td>
</tr>
<tr>
<td>orderingId</td>
<td>Int</td>
<td>Different values: <strong>0</strong>-Alphabetical order ascending, <strong>1</strong>-Total Stock ascending, <strong>2</strong>-Perished date from closest to far away, <strong>3</strong>-Stock quantity close to perish, descending</td>
</tr>
<tr>
<td>offset</td>
<td>Int</td>
<td>Offset value applied to the query</td>
</tr>
</tbody>
</table>
<h2 id="get-professionnal-orders-dashboard">Get professionnal orders dashboard</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'wholesaler-getOrdersDashboard'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"orders"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"order_id"</span><span class="token operator">:</span> <span class="token string">"9390-057749-4545"</span><span class="token punctuation">,</span>
                <span class="token property">"date"</span><span class="token operator">:</span> <span class="token string">"2021-02-27 00:00:00"</span><span class="token punctuation">,</span>
                <span class="token property">"products_count"</span><span class="token operator">:</span> <span class="token number">150</span><span class="token punctuation">,</span>
                <span class="token property">"vat_exempt_price"</span><span class="token operator">:</span> <span class="token number">8370</span><span class="token punctuation">,</span>
                <span class="token property">"pdf_url"</span><span class="token operator">:</span> <span class="token string">"commande-pro/1/9390-057749-4545.pdf"</span><span class="token punctuation">,</span>
                <span class="token property">"supermarket_name"</span><span class="token operator">:</span> <span class="token string">"3HFood Seclin"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"categories"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"À préparer"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"À expédier"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-1</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Expédiées"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-2</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Livrées"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-3</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Total"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-4</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch the first 10 orders to be in “PREPARE” state and the filters for the orders dashboard</p>
<h3 id="http-request-11">HTTP Request</h3>
<p>`GET wholesaler-getOrdersDashboard</p>
<h2 id="get-orders-by-filter">Get orders by filter</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'wholesaler-getOrders'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  categoryId<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">"order_id"</span><span class="token operator">:</span> <span class="token string">"9390-057749-4545"</span><span class="token punctuation">,</span>
            <span class="token property">"date"</span><span class="token operator">:</span> <span class="token string">"2021-02-27 00:00:00"</span><span class="token punctuation">,</span>
            <span class="token property">"products_count"</span><span class="token operator">:</span> <span class="token number">150</span><span class="token punctuation">,</span>
            <span class="token property">"vat_exempt_price"</span><span class="token operator">:</span> <span class="token number">8370</span><span class="token punctuation">,</span>
            <span class="token property">"pdf_url"</span><span class="token operator">:</span> <span class="token string">"commande-pro/1/9390-057749-4545.pdf"</span><span class="token punctuation">,</span>
            <span class="token property">"supermarket_name"</span><span class="token operator">:</span> <span class="token string">"3HFood Seclin"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch wholesaler orders ordered by date and with a mandatory offset.</p>
<p>You have to pass a categoryId which is the filter id fetched from the ordersDashboard query.</p>
<h3 id="http-request-12">HTTP Request</h3>
<p><code>GET wholesaler-getOrders</code></p>
<h3 id="query-parameters-11">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>categoryId</td>
<td>Int</td>
<td>Filter ID as fetched by dashboard call</td>
</tr>
<tr>
<td>offset</td>
<td>Int</td>
<td>Offset value applied to the query</td>
</tr>
</tbody>
</table>
<h1 id="supermarket">Supermarket</h1>
<h2 id="check-if-onboarding-complete">Check if onboarding complete</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-checkIfOnboardingCompleted'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"can_receive_payments"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"button_link"</span><span class="token operator">:</span> <span class="token string">"https://connect.stripe.com/express/GxH7fHI9Ui6T"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Call this endpoint on website launch to check if the supermarket has verified its stripe account.</p>
<p>If “can received payments” equals false, then you need to block all the dashboard and to display a button to redirect him to the stripe onboarding page. The url to the onboarding is provided by the button_link value.</p>
<p>If “can receive payments” equals true, then the dashboard can behave normally. Just fetch the button link to put it on top of the main menu to provide a quick access to the supermarket stripe account (automatically connected, with 2FA on Stripe side).</p>
<h3 id="http-request">HTTP Request</h3>
<p><code>GET supermarket-checkIfOnboardingCompleted</code></p>
<h3 id="query-parameters">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
</table>
<h2 id="get-all-wholesalers">Get all wholesalers</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-getWholesalers'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">"first_name"</span><span class="token operator">:</span> <span class="token string">"MysteryTea"</span><span class="token punctuation">,</span>
            <span class="token property">"last_name"</span><span class="token operator">:</span> <span class="token string">"SASU"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      	<span class="token punctuation">{</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token property">"first_name"</span><span class="token operator">:</span> <span class="token string">"Les bons gâteaux by MysteryTea"</span><span class="token punctuation">,</span>
            <span class="token property">"last_name"</span><span class="token operator">:</span> <span class="token string">"SASU"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch all existing wholesalers, useful for new order screen where the supermarket need to select a wholesaler to be able to fetch its products</p>
<h3 id="http-request-1">HTTP Request</h3>
<p><code>GET supermarket-getWholesalers</code></p>
<h3 id="query-parameters-1">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
</table>
<h2 id="create-professional-order">Create professional order</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-createOrder'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  productLines<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
      quantity<span class="token operator">:</span> <span class="token number">150</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  wholesalerId<span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"pdfUrl"</span><span class="token operator">:</span> <span class="token string">"commande-pro/1/9390-055229-4545.pdf"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoints allow you to pass an array of order lines containing the product ID and a quantity, create the order in database, and fetch the PDF document url right after that to potentially open it in a new tab.</p>
<p>The call takes only product ids so no cheating is possible as the price set on the final order is the one in database.</p>
<h3 id="http-request-2">HTTP Request</h3>
<p><code>GET supermarket-getWholesalers</code></p>
<h3 id="query-parameters-2">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th></th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>productLines</td>
<td></td>
<td>Array</td>
<td>Array of productLine objects</td>
</tr>
<tr>
<td></td>
<td>id</td>
<td>Int</td>
<td>ID of product linked to product line</td>
</tr>
<tr>
<td></td>
<td>quantity</td>
<td>Int</td>
<td>Quantity of product linked to the product line</td>
</tr>
<tr>
<td>wholesalerId</td>
<td></td>
<td>Int</td>
<td>Id of the selected wholesaler</td>
</tr>
</tbody>
</table>
<h2 id="get-professional-orders">Get professional orders</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-getOrders'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  offset<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"orders"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
                <span class="token property">"order_id"</span><span class="token operator">:</span> <span class="token string">"9390-057749-4545"</span><span class="token punctuation">,</span>
                <span class="token property">"wholesaler_id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">"supermarket_id"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                <span class="token property">"date"</span><span class="token operator">:</span> <span class="token string">"2021-02-27 00:00:00"</span><span class="token punctuation">,</span>
                <span class="token property">"products_count"</span><span class="token operator">:</span> <span class="token number">150</span><span class="token punctuation">,</span>
                <span class="token property">"vat_exempt_price"</span><span class="token operator">:</span> <span class="token number">8370</span><span class="token punctuation">,</span>
                <span class="token property">"pdf_url"</span><span class="token operator">:</span> <span class="token string">"commande-pro/1/9390-057749-4545.pdf"</span><span class="token punctuation">,</span>
                <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"DELIVERED"</span><span class="token punctuation">,</span>
                <span class="token property">"stringified_perishments"</span><span class="token operator">:</span> <span class="token string">"[{\"productId\":18,\"quantity\":150,\"perishDate\":\"2021-02-28\"}]"</span><span class="token punctuation">,</span>
                <span class="token property">"professional_name"</span><span class="token operator">:</span> <span class="token string">"MysteryTea SASU"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"totalOrders"</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch professional orders linked to a supermarket with an offset. Every call returns you the total number of orders too for your front end logic on wether or not you can display next/previous buttons.</p>
<h3 id="http-request-3">HTTP Request</h3>
<p><code>GET supermarket-getOrders</code></p>
<h3 id="query-parameters-3">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Offset</td>
<td>Int</td>
<td>Offset applied to results</td>
</tr>
</tbody>
</table>
<h2 id="set-order-as-delivered">Set order as delivered</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-setOrderReceived'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  orderId<span class="token operator">:</span> <span class="token number">9</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"success"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to set a professionnal order as delivered, and set correct stock lines into warehouse stock database with perishment dates.</p>
<h3 id="http-request-4">HTTP Request</h3>
<p><code>GET supermarket-setOrderReceived</code></p>
<h3 id="query-parameters-4">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>orderId</td>
<td>Int</td>
<td>Id of the order to set as delivered</td>
</tr>
</tbody>
</table>
<h2 id="get-warehouse-stock-dashboard">Get warehouse stock dashboard</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-getWarehouseStockDashboard'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"products"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
                <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"categories"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Produits non assignés"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"En rupture"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-1</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Bientôt en rupture"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-2</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"En stock"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-3</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to get the filters categories with labels and products count, and to get the first 10 products from the first filter category.</p>
<p>A product can only be part of one category. So if a product is in stock but is not yet assigned to a warehouse storage alley, then it will only appear in “Produits non assignés” category and not in “en stock” one.</p>
<h3 id="http-request-5">HTTP Request</h3>
<p><code>GET supermarket-getWarehouseStockDashboard</code></p>
<h3 id="query-parameters-5">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
</table>
<h2 id="get-warehouse-storage">Get Warehouse storage</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-getWarehouseStorage'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  categoryId<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
            <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
            <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch products filtered by warehouse stock state (categoryId), with an offset for padding. Every parameter is mandatory.</p>
<h3 id="http-request-6">HTTP Request</h3>
<p><code>GET supermarket-getWarehouseStorage</code></p>
<h3 id="query-parameters-6">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>categoryId</td>
<td>Int</td>
<td>Id of the warehouse stock filter applied</td>
</tr>
<tr>
<td>Offset</td>
<td>Int</td>
<td>Offset applied for pagination</td>
</tr>
</tbody>
</table>
<h2 id="set-storage-alley">Set storage alley</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-setStorageAlley'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  productId<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  storageAlley<span class="token operator">:</span> <span class="token string">"G2"</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"success"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to set a storage alley for an product. It’ll update all the stock lines of the product with the new storage alley value. If no alley was existing, then the product will change category on refresh. If alley was existing, it’ll be overriden.</p>
<p>Next professionnal orders of the same product will automatically be assigned to this storage alley.</p>
<h3 id="http-request-7">HTTP Request</h3>
<p><code>GET supermarket-setStorageAlley</code></p>
<h3 id="query-parameters-7">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>productId</td>
<td>Int</td>
<td>Id of the product to set the storage alley on</td>
</tr>
<tr>
<td>storageAlley</td>
<td>String</td>
<td>Value of the storage alley (max 31 chars)</td>
</tr>
</tbody>
</table>
<h2 id="get-product-details">Get Product Details</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-getProductDetails'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  productId<span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"product"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
            <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
            <span class="token property">"linked_wholesaler"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
            <span class="token property">"length"</span><span class="token operator">:</span> <span class="token number">53</span><span class="token punctuation">,</span>
            <span class="token property">"width"</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
            <span class="token property">"height"</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
            <span class="token property">"weight"</span><span class="token operator">:</span> <span class="token number">288</span><span class="token punctuation">,</span>
            <span class="token property">"selling_unit"</span><span class="token operator">:</span> <span class="token string">"2x12l"</span><span class="token punctuation">,</span>
            <span class="token property">"legal_unit_price"</span><span class="token operator">:</span> <span class="token string">"1,38€/L"</span><span class="token punctuation">,</span>
            <span class="token property">"professional_price"</span><span class="token operator">:</span> <span class="token number">55.8</span><span class="token punctuation">,</span>
            <span class="token property">"retail_price"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">"vat_class"</span><span class="token operator">:</span> <span class="token number">5.5</span><span class="token punctuation">,</span>
            <span class="token property">"composition"</span><span class="token operator">:</span> <span class="token string">"Juste de l'air"</span><span class="token punctuation">,</span>
            <span class="token property">"linked_category"</span><span class="token operator">:</span> <span class="token number">2</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"warehouse_stock"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                <span class="token property">"product_id"</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
                <span class="token property">"supermarket_id"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                <span class="token property">"storage_alley"</span><span class="token operator">:</span> <span class="token string">"E3"</span><span class="token punctuation">,</span>
                <span class="token property">"quantity"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"perish_date"</span><span class="token operator">:</span> <span class="token string">"2021-03-10"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"client_stock"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">"product_id"</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
                <span class="token property">"supermarket_id"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                <span class="token property">"quantity"</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
                <span class="token property">"perish_date"</span><span class="token operator">:</span> <span class="token string">"2021-03-03"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch product details, as well as the warehouse stock lines, and the client stock lines, order by perishment date from closer to more far away from perishment.</p>
<h3 id="http-request-8">HTTP Request</h3>
<p><code>GET supermarket-getProductDetails</code></p>
<h3 id="query-parameters-8">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>productId</td>
<td>Int</td>
<td>Id of the product you want to fetch details for</td>
</tr>
</tbody>
</table>
<h2 id="update-product">Update product</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-updateProduct'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  	productId<span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
    warehouse<span class="token operator">:</span> <span class="token punctuation">{</span>
      editionLines<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          id<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
          quantity<span class="token operator">:</span> <span class="token number">150</span><span class="token punctuation">,</span>
          perishDate<span class="token operator">:</span> <span class="token string">"2021-03-20"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
        newLines<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            quantity<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
            perishDate<span class="token operator">:</span> <span class="token string">"2021-04-01"</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
          deletionLines<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
      client<span class="token operator">:</span> <span class="token punctuation">{</span>
        editionLines<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            id<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            quantity<span class="token operator">:</span> <span class="token number">150</span><span class="token punctuation">,</span>
            perishDate<span class="token operator">:</span> <span class="token string">"2021-03-20"</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
          newLines<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
              quantity<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
              perishDate<span class="token operator">:</span> <span class="token string">"2021-04-01"</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
            deletionLines<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"success"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to update product warehouse stock and client stock.</p>
<h3 id="http-request-9">HTTP Request</h3>
<p><code>GET supermarket-updateProduct</code></p>
<h3 id="query-parameters-9">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th></th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>productId</td>
<td></td>
<td>Int</td>
<td>Id of the product you want to fetch details for</td>
</tr>
<tr>
<td>warehouse</td>
<td></td>
<td>Object</td>
<td>Object containing all line editions</td>
</tr>
<tr>
<td>warehouse.editionLines</td>
<td></td>
<td>Array</td>
<td>Array containing all edited warehouse stock lines in product</td>
</tr>
<tr>
<td></td>
<td>id</td>
<td>Int</td>
<td>Id of the edited stock line</td>
</tr>
<tr>
<td></td>
<td>quantity</td>
<td>Int</td>
<td>New quantity value for the line</td>
</tr>
<tr>
<td></td>
<td>perishDate</td>
<td>Date</td>
<td>New perish date for the line</td>
</tr>
<tr>
<td>warehouse.newLines</td>
<td></td>
<td>Array</td>
<td>Array containing all inserted warehouse stock lines for product</td>
</tr>
<tr>
<td></td>
<td>quantity</td>
<td>Int</td>
<td>Inserted quantity</td>
</tr>
<tr>
<td></td>
<td>perishDate</td>
<td>Date</td>
<td>Inserted perish date</td>
</tr>
<tr>
<td>warehouse.deletionLines</td>
<td></td>
<td>Array<Int></td>
<td>Array of deleted stock line ids</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>client</td>
<td></td>
<td>Object</td>
<td>Object containing all line editions</td>
</tr>
<tr>
<td>client.editionLines</td>
<td></td>
<td>Array</td>
<td>Array containing all edited warehouse stock lines in productObject containing all line editions</td>
</tr>
<tr>
<td></td>
<td>id</td>
<td>Int</td>
<td>Id of the edited stock line</td>
</tr>
<tr>
<td></td>
<td>quantity</td>
<td>Int</td>
<td>New quantity value for the line</td>
</tr>
<tr>
<td></td>
<td>perishDate</td>
<td>Date</td>
<td>New perish date for the line</td>
</tr>
<tr>
<td>warehouse.newLines</td>
<td></td>
<td>Array</td>
<td>Array containing all inserted warehouse stock lines for product</td>
</tr>
<tr>
<td></td>
<td>quantity</td>
<td>Int</td>
<td>Inserted quantity</td>
</tr>
<tr>
<td></td>
<td>perishDate</td>
<td>Date</td>
<td>Inserted perish date</td>
</tr>
<tr>
<td>warehouse.deletionLines</td>
<td></td>
<td>Array<Int></td>
<td>Array of deleted stock line ids</td>
</tr>
</tbody>
</table>
<h2 id="get-client-stock-detail">Get Client Stock Detail</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-getClientStockDetails'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"products"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
                <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"categories"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"En rupture"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Bientôt en rupture"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-1</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"En stock"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-2</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch client stock filters and the first 10 products from the first filter (out of stock products)</p>
<h3 id="http-request-10">HTTP Request</h3>
<p><code>GET supermarket-getClientStockDetails</code></p>
<h3 id="query-parameters-10">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>productId</td>
<td>Int</td>
<td>Id of the product you want to fetch details for</td>
</tr>
</tbody>
</table>
<h2 id="get-client-stock">Get Client Stock</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-getClientStock'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  categoryId<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
            <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
            <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch client stock filters and the first 10 products from the first filter (out of stock products)</p>
<h3 id="http-request-11">HTTP Request</h3>
<p><code>GET supermarket-getClientStock</code></p>
<h3 id="query-parameters-11">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>categoryId</td>
<td>Int</td>
<td>Id of the client stock product filter</td>
</tr>
<tr>
<td>offset</td>
<td>Int</td>
<td>Value of the applied offset</td>
</tr>
</tbody>
</table>
<h2 id="get-perishment-dashboard">Get perishment dashboard</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-getOrdersDashboard'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"products"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
                <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
                <span class="token property">"perished_warehouse_quantity"</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
                <span class="token property">"closest_perishment_date"</span><span class="token operator">:</span> <span class="token string">"2021-02-24"</span><span class="token punctuation">,</span>
                <span class="token property">"perished_client_quantity"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"closest_client_date"</span><span class="token operator">:</span> <span class="token null keyword">null</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
                <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
                <span class="token property">"perished_warehouse_quantity"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"closest_perishment_date"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
                <span class="token property">"perished_client_quantity"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"closest_client_date"</span><span class="token operator">:</span> <span class="token null keyword">null</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"categories"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Périmés"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Périment dans -7j"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-1</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Périment dans -14j"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-2</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch the perishment dashboard, with the first 10 products of the first filter, and all the filters for the side selector.</p>
<h3 id="http-request-12">HTTP Request</h3>
<p><code>GET supermarket-getOrdersDashboard</code></p>
<h3 id="query-parameters-12">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
</table>
<h2 id="get-perishment">Get perishment</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-getPerishments'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  categoryId<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
            <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
            <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
            <span class="token property">"perished_warehouse_quantity"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"closest_perishment_date"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"perished_client_quantity"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"closest_client_date"</span><span class="token operator">:</span> <span class="token null keyword">null</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
            <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
            <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://google.fr"</span><span class="token punctuation">,</span>
            <span class="token property">"perished_warehouse_quantity"</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
            <span class="token property">"closest_perishment_date"</span><span class="token operator">:</span> <span class="token string">"2021-02-24"</span><span class="token punctuation">,</span>
            <span class="token property">"perished_client_quantity"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"closest_client_date"</span><span class="token operator">:</span> <span class="token null keyword">null</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch filtered perishment products</p>
<h3 id="http-request-13">HTTP Request</h3>
<p><code>GET supermarket-getPerishments</code></p>
<h3 id="query-parameters-13">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>categoryId</td>
<td>Int</td>
<td>Id of the perishments filter</td>
</tr>
<tr>
<td>offset</td>
<td>Int</td>
<td>Value of the applied offset</td>
</tr>
</tbody>
</table>
<h2 id="delete-perished-stock">Delete perished stock</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-deletePerishedProductStock'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  productId<span class="token operator">:</span> <span class="token number">17</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"success"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to delete all perished stock lines from warehouse and client supermarket stock</p>
<h3 id="http-request-14">HTTP Request</h3>
<p><code>GET supermarket-deletePerishedProductStock</code></p>
<h3 id="query-parameters-14">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>productId</td>
<td>Int</td>
<td>Id of the product from whom remove the perished stock</td>
</tr>
</tbody>
</table>
<h2 id="create-discount">Create discount</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-createDiscount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"Promo test"</span><span class="token punctuation">,</span>
  categories<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  products<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  promotionType<span class="token operator">:</span> <span class="token string">"BOGO"</span><span class="token punctuation">,</span>
  boughtQuantity<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  paidQuantity<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  startDate<span class="token operator">:</span> <span class="token string">"2021-03-20"</span><span class="token punctuation">,</span>
  endDate<span class="token operator">:</span> <span class="token string">"2021-03-31"</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"success"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to create a new discount for products and/or categories</p>
<h3 id="http-request-15">HTTP Request</h3>
<p><code>GET supermarket-createDiscount</code></p>
<h3 id="query-parameters-15">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td>String</td>
<td>Name of the promotion. Will be shown client side so choose it wisely (max 255 chars)</td>
</tr>
<tr>
<td>categories</td>
<td>[Int]</td>
<td>Array of category ids the discount can be applied for. Empty array if no category applicable. Must at least have a non empty category array or a non empty product array.</td>
</tr>
<tr>
<td>products</td>
<td>[Int]</td>
<td>Array of product ids the discount can be applied for. Empty array if no product applicable. Must at least have a non empty category array or a non empty product array.</td>
</tr>
<tr>
<td>promotionType</td>
<td>String</td>
<td>Promotion type between these values: <strong>BOGO</strong>: Buy X Pay Y system (recursive). <strong>PERCENTAGE</strong>: the value will be a percentage of the product’s price. <strong>DIRECT</strong>: the value will be an amount in euros.</td>
</tr>
<tr>
<td>boughtQuantity</td>
<td>Int?</td>
<td><strong>Only if BOGO</strong>: Quantity of products to buy to activate the discount</td>
</tr>
<tr>
<td>paidQuantity</td>
<td>Int?</td>
<td><strong>Only if BOGO</strong>: Quantity of products the client will pay after the discount</td>
</tr>
<tr>
<td>value</td>
<td>Float?</td>
<td><strong>Only if PERCENTAGE or DIRECT</strong>: the value of the discount. Eg 15 for -15%, or 0.80 for 0.80€</td>
</tr>
<tr>
<td>startDate</td>
<td>Date</td>
<td>Start date of the discount. Format YYYY-MM-DD</td>
</tr>
<tr>
<td>enddate</td>
<td>Date</td>
<td>End date of the discount. Format YYYY-MM-DD. No verification is done for endDate &gt; startDate, must be done client side.</td>
</tr>
</tbody>
</table>
<h2 id="get-discount-dashboard">Get discount dashboard</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-getDiscountDashboard'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"promotions"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
                <span class="token property">"promotion_group_id"</span><span class="token operator">:</span> <span class="token string">"f4524049-4476-46f0-b84d-60e796ff85b8"</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Deuxième promo"</span><span class="token punctuation">,</span>
                <span class="token property">"eligible_category"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token property">"eligible_product"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
                <span class="token property">"promotion_type"</span><span class="token operator">:</span> <span class="token string">"BOGO"</span><span class="token punctuation">,</span>
                <span class="token property">"bought_quantity"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
                <span class="token property">"paid_quantity"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token property">"value"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
                <span class="token property">"start_date"</span><span class="token operator">:</span> <span class="token string">"2021-03-02"</span><span class="token punctuation">,</span>
                <span class="token property">"end_date"</span><span class="token operator">:</span> <span class="token string">"2021-03-12"</span><span class="token punctuation">,</span>
                <span class="token property">"eligible_products"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
                <span class="token property">"eligible_categories"</span><span class="token operator">:</span> <span class="token string">"Biscuits\nChips"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
                <span class="token property">"promotion_group_id"</span><span class="token operator">:</span> <span class="token string">"b1945963-d9a1-4925-b6e3-03517f95d01c"</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Promo test"</span><span class="token punctuation">,</span>
                <span class="token property">"eligible_category"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
                <span class="token property">"eligible_product"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
                <span class="token property">"promotion_type"</span><span class="token operator">:</span> <span class="token string">"DIRECT"</span><span class="token punctuation">,</span>
                <span class="token property">"bought_quantity"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
                <span class="token property">"paid_quantity"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
                <span class="token property">"value"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
                <span class="token property">"start_date"</span><span class="token operator">:</span> <span class="token string">"2021-03-03"</span><span class="token punctuation">,</span>
                <span class="token property">"end_date"</span><span class="token operator">:</span> <span class="token string">"2021-03-15"</span><span class="token punctuation">,</span>
                <span class="token property">"eligible_products"</span><span class="token operator">:</span> <span class="token string">"Deuxième produit\nProduit test"</span><span class="token punctuation">,</span>
                <span class="token property">"eligible_categories"</span><span class="token operator">:</span> <span class="token null keyword">null</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"categories"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"En cours"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"À venir"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-1</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"category_product_count"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"category_name"</span><span class="token operator">:</span> <span class="token string">"Passées"</span><span class="token punctuation">,</span>
                <span class="token property">"category_id"</span><span class="token operator">:</span> <span class="token number">-2</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch the first 10 currently active discounts and the side filters with discounts count.</p>
<p><strong>NOTE</strong>: The eligible products/categories are rendered as plain text separated by new lines “\n”. You can consider acceptable render them directly in HTML.</p>
<h3 id="http-request-16">HTTP Request</h3>
<p><code>GET supermarket-getDiscountDashboard</code></p>
<h3 id="query-parameters-16">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
</table>
<h2 id="get-discount">Get discount</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-getDiscount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token string">"b1945963-d9a1-4925-b6e3-03517f95d01c"</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token property">"promotion_group_id"</span><span class="token operator">:</span> <span class="token string">"b1945963-d9a1-4925-b6e3-03517f95d01c"</span><span class="token punctuation">,</span>
        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Promo test"</span><span class="token punctuation">,</span>
        <span class="token property">"promotion_type"</span><span class="token operator">:</span> <span class="token string">"DIRECT"</span><span class="token punctuation">,</span>
        <span class="token property">"bought_quantity"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"paid_quantity"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token property">"start_date"</span><span class="token operator">:</span> <span class="token string">"2021-03-03"</span><span class="token punctuation">,</span>
        <span class="token property">"end_date"</span><span class="token operator">:</span> <span class="token string">"2021-03-15"</span><span class="token punctuation">,</span>
        <span class="token property">"products"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Deuxième produit"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"categories"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch discount detail for discount edition view</p>
<h3 id="http-request-17">HTTP Request</h3>
<p><code>GET supermarket-getDiscount</code></p>
<h3 id="query-parameters-17">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>Int</td>
<td>Id of the product promotion group you want to get details for</td>
</tr>
</tbody>
</table>
<h2 id="update-discount">Update discount</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-updateDiscount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    discount<span class="token operator">:</span> <span class="token punctuation">{</span>
      promotionGroupId<span class="token operator">:</span> <span class="token string">"b1945963-d9a1-4925-b6e3-03517f95d01c"</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">"Nouveau nom"</span><span class="token punctuation">,</span>
      type<span class="token operator">:</span> <span class="token string">"PERCENTAGE"</span><span class="token punctuation">,</span>
      value<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
      startDate<span class="token operator">:</span> <span class="token string">"2021-03-01"</span><span class="token punctuation">,</span>
      endDate<span class="token operator">:</span> <span class="token string">"2021-03-31"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    productDeletions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    categoryDeletions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    productAdditions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    categoryAdditions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"success"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to update discount</p>
<h3 id="http-request-18">HTTP Request</h3>
<p><code>GET supermarket-updateDiscount</code></p>
<h3 id="query-parameters-18">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th></th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>discount</td>
<td></td>
<td>Map</td>
<td>Discount object</td>
</tr>
<tr>
<td></td>
<td>promotionGroupId</td>
<td>String</td>
<td>The UUID (not the id) of the discount. As each eligible product/category in a discount has a different discount id, it is used to define membership of a unique discount</td>
</tr>
<tr>
<td></td>
<td>name</td>
<td>String</td>
<td>The new name of the discount</td>
</tr>
<tr>
<td></td>
<td>type</td>
<td>String</td>
<td>The new type of the discount. See Create Discount for more info</td>
</tr>
<tr>
<td></td>
<td>boughtQuantity</td>
<td>Int?</td>
<td>New needed quantity to unlock the discount</td>
</tr>
<tr>
<td></td>
<td>paidQuantity</td>
<td>Int?</td>
<td>New really paid quantity after the discount has been unlocked</td>
</tr>
<tr>
<td></td>
<td>value</td>
<td>Float</td>
<td>New discount value</td>
</tr>
<tr>
<td></td>
<td>startDate</td>
<td>Date</td>
<td>New start date format YYYY-MM-DD</td>
</tr>
<tr>
<td></td>
<td>endDate</td>
<td>Date</td>
<td>New end date format YYYY-MM-DD</td>
</tr>
<tr>
<td>productDeletions</td>
<td></td>
<td>[Int]</td>
<td>Array of product ids to delete from the discount availability</td>
</tr>
<tr>
<td>categoryDeletions</td>
<td></td>
<td>[Int]</td>
<td>Array of category ids to delete from the discount availability</td>
</tr>
<tr>
<td>productAdditions</td>
<td></td>
<td>[Int]</td>
<td>Array of product ids to add to the discount availability</td>
</tr>
<tr>
<td>categoryAdditions</td>
<td></td>
<td>[Int]</td>
<td>Array of category ids to add to the discount availability</td>
</tr>
</tbody>
</table>
<h2 id="delete-discount">Delete discount</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-deleteDiscount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token string">"b1945963-d9a1-4925-b6e3-03517f95d01c"</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"success"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you completely delete a discount.</p>
<h3 id="http-request-19">HTTP Request</h3>
<p><code>GET supermarket-deleteDiscount</code></p>
<h3 id="query-parameters-19">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>Int</td>
<td>Id of the product promotion group you want to delete.</td>
</tr>
</tbody>
</table>
<h2 id="get-reviews">Get reviews</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-getReviews'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  offset<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"reviews"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"full_name"</span><span class="token operator">:</span> <span class="token string">"Benjamin Huygens"</span><span class="token punctuation">,</span>
                <span class="token property">"note"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token property">"message"</span><span class="token operator">:</span> <span class="token string">"J'ai glissé sur le sol et je me suis fait les ligaments croisés. Quel dommage je vais devoir arrêter le football en compétition. J'ai porté plainte contre le magasin."</span><span class="token punctuation">,</span>
                <span class="token property">"date"</span><span class="token operator">:</span> <span class="token string">"2021-03-07"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"average_note"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">"reviews_count"</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch 10 clients reviews with an offset, the average note given to your supermarket, and the total reviews count</p>
<h3 id="http-request-20">HTTP Request</h3>
<p><code>GET supermarket-getReviews</code></p>
<h3 id="query-parameters-20">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>offset</td>
<td>Int</td>
<td>Offset applied to results</td>
</tr>
</tbody>
</table>
<h2 id="get-product-price">Get product price</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-getProductPrice'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  productId<span class="token operator">:</span> <span class="token number">17</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">"value"</span><span class="token operator">:</span> <span class="token number">86.9</span><span class="token punctuation">,</span>
            <span class="token property">"professional_price"</span><span class="token operator">:</span> <span class="token number">22.8</span><span class="token punctuation">,</span>
            <span class="token property">"margin"</span><span class="token operator">:</span> <span class="token number">64.10000228881836</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you to fetch the professionnal price, the set retail price on supermarket side, and the given margin. The value can be 0 if product hasn’t been assigned to a price yet, and so the margin will be negative.</p>
<h3 id="http-request-21">HTTP Request</h3>
<p><code>GET supermarket-getProductPrice</code></p>
<h3 id="query-parameters-21">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>productId</td>
<td>Int</td>
<td>Id of the product to get the price from</td>
</tr>
</tbody>
</table>
<h2 id="set-product-price">Set product price</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'supermarket-setProductPrice'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  productId<span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
  price<span class="token operator">:</span> <span class="token number">29.9</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"success"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint allows you set a product price for a given supermarket.</p>
<h3 id="http-request-22">HTTP Request</h3>
<p><code>GET supermarket-setProductPrice</code></p>
<h3 id="query-parameters-22">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>productId</td>
<td>Int</td>
<td>Id of the product to set the price to</td>
</tr>
<tr>
<td>price</td>
<td>Float</td>
<td>The price to set</td>
</tr>
</tbody>
</table>
<h1 id="search">Search</h1>
<h2 id="search-in-wholesaler-products">Search in wholesaler products</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'search-wholesalerProduct'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  search<span class="token operator">:</span> <span class="token string">"test"</span><span class="token punctuation">,</span>
  categoryId<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"results"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://mysterytea-website.s3.eu-west-3.amazonaws.com/assets/2020/08/21181335/NEW-FraiseFleurieDoypack.png"</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
                <span class="token property">"stock_quantity"</span><span class="token operator">:</span> <span class="token number">9550</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"count"</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoints allows you to fetch products for a search query from the wholesaler products dashboard. It is filtered by the current category filter on the dashboard.</p>
<h3 id="http-request">HTTP Request</h3>
<p><code>GET search-wholesalerProduct</code></p>
<h3 id="query-parameters">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>search</td>
<td>String</td>
<td>Search query string. Minimum 3 chars or you’ll get an INVALIDARGUMENT error</td>
</tr>
<tr>
<td>categoryId</td>
<td>Int</td>
<td>Currently active category id</td>
</tr>
<tr>
<td>offset</td>
<td>Int</td>
<td>Offset applied to results</td>
</tr>
</tbody>
</table>
<h2 id="search-in-categories-(common)">Search in categories (COMMON)</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'search-commonCategory'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  search<span class="token operator">:</span> <span class="token string">"Bisc"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Biscuits"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoints allows you to fetch categories responding to a query. Results are limited to 5.</p>
<h3 id="http-request-1">HTTP Request</h3>
<p><code>GET search-commonCategory</code></p>
<h3 id="query-parameters-1">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>search</td>
<td>String</td>
<td>Search query string. Minimum 3 chars or you’ll get an INVALIDARGUMENT error</td>
</tr>
</tbody>
</table>
<h2 id="search-tracker-line">Search tracker line</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'search-wholesalerTrackingLines'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  search<span class="token operator">:</span> <span class="token string">"secl"</span><span class="token punctuation">,</span>
  orderingId<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"results"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                <span class="token property">"first_name"</span><span class="token operator">:</span> <span class="token string">"3HFood"</span><span class="token punctuation">,</span>
                <span class="token property">"last_name"</span><span class="token operator">:</span> <span class="token string">"Seclin"</span><span class="token punctuation">,</span>
                <span class="token property">"near_perishment_references_count"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">"perished_products_count"</span><span class="token operator">:</span> <span class="token number">250</span><span class="token punctuation">,</span>
                <span class="token property">"references_count"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token property">"products_count"</span><span class="token operator">:</span> <span class="token number">750</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"count"</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoints allows you to fetch tracker lines for a given query string.</p>
<h3 id="http-request-2">HTTP Request</h3>
<p><code>GET search-wholesalerTrackingLines</code></p>
<h3 id="query-parameters-2">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>search</td>
<td>String</td>
<td>Search query string. Minimum 3 chars or you’ll get an INVALIDARGUMENT error</td>
</tr>
<tr>
<td>orderingId</td>
<td>Int</td>
<td>Different values: <strong>0</strong>-Alphabetical order ascending, <strong>1</strong>-Near perishment references count descending, <strong>2</strong>-Perished products count descending</td>
</tr>
<tr>
<td>offset</td>
<td>Int</td>
<td>Applied offset to the query for pagination</td>
</tr>
</tbody>
</table>
<h2 id="search-tracker-details">Search tracker details</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'search-wholesalerTrackingDetail'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  search<span class="token operator">:</span> <span class="token string">"deux"</span><span class="token punctuation">,</span>
  supermarketId<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
  orderingId<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"results"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"product_id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Deuxième produit"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
                <span class="token property">"total_stock"</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
                <span class="token property">"nearest_perish_date"</span><span class="token operator">:</span> <span class="token string">"2021-03-17"</span><span class="token punctuation">,</span>
                <span class="token property">"near_perish_stock"</span><span class="token operator">:</span> <span class="token number">600</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"count"</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoints allows you to fetch tracker products for a given query string</p>
<h3 id="http-request-3">HTTP Request</h3>
<p><code>GET search-wholesalerTrackingLines</code></p>
<h3 id="query-parameters-3">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>search</td>
<td>String</td>
<td>Search query string. Minimum 3 chars or you’ll get an INVALIDARGUMENT error</td>
</tr>
<tr>
<td>supermarketId</td>
<td>Int</td>
<td>ID of the supermarket to fetch lines from</td>
</tr>
<tr>
<td>orderingId</td>
<td>Int</td>
<td>Different values: <strong>0</strong>-Alphabetical order ascending, <strong>1</strong>-Total Stock ascending, <strong>2</strong>-Perished date from closest to far away, <strong>3</strong>-Stock quantity close to perish, descending</td>
</tr>
<tr>
<td>offset</td>
<td>Int</td>
<td>Applied offset to the query for pagination</td>
</tr>
</tbody>
</table>
<h2 id="search-wholesaler-orders">Search wholesaler orders</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'search-wholesalerOrders'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  search<span class="token operator">:</span> <span class="token string">"secl"</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  filterId<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">3</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"results"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"order_id"</span><span class="token operator">:</span> <span class="token string">"9390-057749-4545"</span><span class="token punctuation">,</span>
                <span class="token property">"date"</span><span class="token operator">:</span> <span class="token string">"2021-02-27 00:00:00"</span><span class="token punctuation">,</span>
                <span class="token property">"products_count"</span><span class="token operator">:</span> <span class="token number">150</span><span class="token punctuation">,</span>
                <span class="token property">"vat_exempt_price"</span><span class="token operator">:</span> <span class="token number">8370</span><span class="token punctuation">,</span>
                <span class="token property">"pdf_url"</span><span class="token operator">:</span> <span class="token string">"commande-pro/1/9390-057749-4545.pdf"</span><span class="token punctuation">,</span>
                <span class="token property">"supermarket_name"</span><span class="token operator">:</span> <span class="token string">"3HFood Seclin"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"count"</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoints allows you to fetch professionnal orders for a given query string</p>
<h3 id="http-request-4">HTTP Request</h3>
<p><code>GET search-wholesalerOrders</code></p>
<h3 id="query-parameters-4">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>search</td>
<td>String</td>
<td>Search query string. Minimum 3 chars or you’ll get an INVALIDARGUMENT error</td>
</tr>
<tr>
<td>offset</td>
<td>Int</td>
<td>Applied offset to the query for pagination</td>
</tr>
<tr>
<td>filterId</td>
<td>Int</td>
<td>The current orders filter applied</td>
</tr>
</tbody>
</table>
<h2 id="search-wholesaler-perishments">Search wholesaler perishments</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'search-wholesalerPerishments'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  search<span class="token operator">:</span> <span class="token string">"secl"</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  filterId<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">3</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"results"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://mysterytea-website.s3.eu-west-3.amazonaws.com/assets/2020/08/21181335/NEW-FraiseFleurieDoypack.png"</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Deuxième produit"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
                <span class="token property">"perished_quantity"</span><span class="token operator">:</span> <span class="token number">9550</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"count"</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoints allows you to fetch perishments for a given query string</p>
<h3 id="http-request-5">HTTP Request</h3>
<p><code>GET search-wholesalerPerishments</code></p>
<h3 id="query-parameters-5">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>search</td>
<td>String</td>
<td>Search query string. Minimum 3 chars or you’ll get an INVALIDARGUMENT error</td>
</tr>
<tr>
<td>offset</td>
<td>Int</td>
<td>Applied offset to the query for pagination</td>
</tr>
<tr>
<td>filterId</td>
<td>Int</td>
<td>The current orders filter applied</td>
</tr>
</tbody>
</table>
<h2 id="search-supermarket-orders">Search supermarket orders</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'search-supermarketOrders'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  search<span class="token operator">:</span> <span class="token string">"Myst"</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"results"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
                <span class="token property">"order_id"</span><span class="token operator">:</span> <span class="token string">"9390-057749-4545"</span><span class="token punctuation">,</span>
                <span class="token property">"wholesaler_id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">"supermarket_id"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                <span class="token property">"date"</span><span class="token operator">:</span> <span class="token string">"2021-02-27 00:00:00"</span><span class="token punctuation">,</span>
                <span class="token property">"products_count"</span><span class="token operator">:</span> <span class="token number">150</span><span class="token punctuation">,</span>
                <span class="token property">"vat_exempt_price"</span><span class="token operator">:</span> <span class="token number">8370</span><span class="token punctuation">,</span>
                <span class="token property">"pdf_url"</span><span class="token operator">:</span> <span class="token string">"commande-pro/1/9390-057749-4545.pdf"</span><span class="token punctuation">,</span>
                <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"DELIVERED"</span><span class="token punctuation">,</span>
                <span class="token property">"stringified_perishments"</span><span class="token operator">:</span> <span class="token string">"[{\"productId\":18,\"quantity\":150,\"perishDate\":\"2021-02-28\"}]"</span><span class="token punctuation">,</span>
                <span class="token property">"professional_name"</span><span class="token operator">:</span> <span class="token string">"MysteryTea SASU"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"count"</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoints allows you to fetch supermarket orders with a given wholesaler name or order id</p>
<h3 id="http-request-6">HTTP Request</h3>
<p><code>GET search-supermarketOrders</code></p>
<h3 id="query-parameters-6">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>search</td>
<td>String</td>
<td>Search query string. Minimum 3 chars or you’ll get an INVALIDARGUMENT error</td>
</tr>
<tr>
<td>offset</td>
<td>Int</td>
<td>Applied offset to the query for pagination</td>
</tr>
</tbody>
</table>
<h2 id="search-product-for-supermarket-new-order">Search product for supermarket new order</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'search-supermarketProductOnOrder'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  search<span class="token operator">:</span> <span class="token string">"Prod"</span><span class="token punctuation">,</span>
  wholesalerId<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
            <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
            <span class="token property">"professional_price"</span><span class="token operator">:</span> <span class="token number">22.8</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
            <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Deuxième produit"</span><span class="token punctuation">,</span>
            <span class="token property">"professional_price"</span><span class="token operator">:</span> <span class="token number">55.8</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoints allows you to get autocompletion for product search feature on new order screen, with price information for each suggestion in order to build the order properly.</p>
<h3 id="http-request-7">HTTP Request</h3>
<p><code>GET search-supermarketProductOnOrder</code></p>
<h3 id="query-parameters-7">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>search</td>
<td>String</td>
<td>Search query string. Minimum 3 chars or you’ll get an INVALIDARGUMENT error</td>
</tr>
<tr>
<td>wholesalerId</td>
<td>Int</td>
<td>The selected wholesaler id from the dropdown on new order screen</td>
</tr>
</tbody>
</table>
<h2 id="search-product-for-supermarket-other-screens">Search product for supermarket other screens</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'search-supermarketProductIdAndName'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  search<span class="token operator">:</span> <span class="token string">"Prod"</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Deuxième produit"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoints allows you to fetch product results on query for optimisation and pricing screens</p>
<h3 id="http-request-8">HTTP Request</h3>
<p><code>GET search-supermarketProductIdAndName</code></p>
<h3 id="query-parameters-8">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>search</td>
<td>String</td>
<td>Search query string. Minimum 3 chars or you’ll get an INVALIDARGUMENT error</td>
</tr>
</tbody>
</table>
<h2 id="search-supermarket-warehouse-stock">Search supermarket warehouse stock</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'search-supermarketWarehouseStock'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  search<span class="token operator">:</span> <span class="token string">"Prod"</span><span class="token punctuation">,</span>
  categoryId<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"results"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
                <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://mysterytea-website.s3.eu-west-3.amazonaws.com/assets/2020/08/21181335/NEW-FraiseFleurieDoypack.png"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Deuxième produit"</span><span class="token punctuation">,</span>
                <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://mysterytea-website.s3.eu-west-3.amazonaws.com/assets/2020/08/21181335/NEW-FraiseFleurieDoypack.png"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"count"</span><span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoints allows you to search for specific products on warehouse stock screen</p>
<h3 id="http-request-9">HTTP Request</h3>
<p><code>GET search-supermarketWarehouseStock</code></p>
<h3 id="query-parameters-9">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>search</td>
<td>String</td>
<td>Search query string. Minimum 3 chars or you’ll get an INVALIDARGUMENT error</td>
</tr>
<tr>
<td>categoryId</td>
<td>Int</td>
<td>The selected warehouse stock filter</td>
</tr>
<tr>
<td>offset</td>
<td>Int</td>
<td>Offset applied to the query for pagination</td>
</tr>
</tbody>
</table>
<h2 id="search-supermarket-client-stock">Search supermarket client stock</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'search-supermarketClientStock'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  search<span class="token operator">:</span> <span class="token string">"Prod"</span><span class="token punctuation">,</span>
  categoryId<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"results"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Deuxième produit"</span><span class="token punctuation">,</span>
                <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://mysterytea-website.s3.eu-west-3.amazonaws.com/assets/2020/08/21181335/NEW-FraiseFleurieDoypack.png"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Produit test"</span><span class="token punctuation">,</span>
                <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://mysterytea-website.s3.eu-west-3.amazonaws.com/assets/2020/08/21181335/NEW-FraiseFleurieDoypack.png"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"count"</span><span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoints allows you to search for specific products in client stock</p>
<h3 id="http-request-10">HTTP Request</h3>
<p><code>GET search-supermarketClientStock</code></p>
<h3 id="query-parameters-10">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>search</td>
<td>String</td>
<td>Search query string. Minimum 3 chars or you’ll get an INVALIDARGUMENT error</td>
</tr>
<tr>
<td>categoryId</td>
<td>Int</td>
<td>The selected client stock filter</td>
</tr>
<tr>
<td>offset</td>
<td>Int</td>
<td>Offset applied to the query for pagination</td>
</tr>
</tbody>
</table>
<h2 id="search-supermarket-perishments">Search supermarket perishments</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'search-supermarketPerishments'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token operator">:</span><span class="token punctuation">{</span>
  search<span class="token operator">:</span> <span class="token string">"Prod"</span><span class="token punctuation">,</span>
  categoryId<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"results"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Deuxième produit"</span><span class="token punctuation">,</span>
                <span class="token property">"ean"</span><span class="token operator">:</span> <span class="token string">"123456431334545"</span><span class="token punctuation">,</span>
                <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://mysterytea-website.s3.eu-west-3.amazonaws.com/assets/2020/08/21181335/NEW-FraiseFleurieDoypack.png"</span><span class="token punctuation">,</span>
                <span class="token property">"perished_warehouse_quantity"</span><span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span>
                <span class="token property">"closest_perishment_date"</span><span class="token operator">:</span> <span class="token string">"2021-03-17"</span><span class="token punctuation">,</span>
                <span class="token property">"perished_client_quantity"</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
                <span class="token property">"closest_client_date"</span><span class="token operator">:</span> <span class="token string">"2021-03-17"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"count"</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoints allows you to search for specific products in perishment dashboard</p>
<h3 id="http-request-11">HTTP Request</h3>
<p><code>GET search-supermarketPerishments</code></p>
<h3 id="query-parameters-11">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>search</td>
<td>String</td>
<td>Search query string. Minimum 3 chars or you’ll get an INVALIDARGUMENT error</td>
</tr>
<tr>
<td>categoryId</td>
<td>Int</td>
<td>The selected perishment screen filter</td>
</tr>
<tr>
<td>offset</td>
<td>Int</td>
<td>Offset applied to the query for pagination</td>
</tr>
</tbody>
</table>
<h1 id="errors">Errors</h1>
<aside class="notice">
This error section is stored in a separate file in <code>includes/errors.md</code>. Slate allows you to optionally separate out your docs into many files...just save them to the <code>includes</code> folder and add them to the top of your <code>index.md</code>'s frontmatter. Files are included in the order listed.
</aside>
<p>The Kittn API uses the following error codes:</p>
<table>
<thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>400</td>
<td>Bad Request – Your request is invalid.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized – Your API key is wrong.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden – The kitten requested is hidden for administrators only.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found – The specified kitten could not be found.</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed – You tried to access a kitten with an invalid method.</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable – You requested a format that isn’t json.</td>
</tr>
<tr>
<td>410</td>
<td>Gone – The kitten requested has been removed from our servers.</td>
</tr>
<tr>
<td>418</td>
<td>I’m a teapot.</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests – You’re requesting too many kittens! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error – We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable – We’re temporarily offline for maintenance. Please try again later.</td>
</tr>
</tbody>
</table>
<h1 id="client---cart">Client - Cart</h1>
<h2 id="create-cart">Create cart</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'client-cart-createCart'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"cart_id"</span><span class="token operator">:</span> <span class="token string">"9ae821ec-b447-4abf-bd28-126518acad81"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint generates a cart id, store it to your user profile, and return it to you.</p>
<p><strong>Be careful, it will overwrite any existing cart uuid on your user profile.</strong></p>
<h3 id="http-request">HTTP Request</h3>
<p><code>GET client-cart-createCart</code></p>
<h3 id="query-parameters">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
</table>
<h2 id="add-product-to-cart">Add product to cart</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'client-cart-addProductToCart'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  productId<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  supermarketId<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
  quantity<span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"line_items"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"quantity"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                <span class="token property">"applied_coupon"</span><span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
                <span class="token property">"carbon_footprint"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://mysterytea-website.s3.eu-west-3.amazonaws.com/assets/2020/08/21181335/NEW-FraiseFleurieDoypack.png"</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Deuxième produit"</span><span class="token punctuation">,</span>
                <span class="token property">"line_value"</span><span class="token operator">:</span> <span class="token number">119.5999984741211</span><span class="token punctuation">,</span>
                <span class="token property">"selling_unit"</span><span class="token operator">:</span> <span class="token string">"2x12l"</span><span class="token punctuation">,</span>
                <span class="token property">"brand_name"</span><span class="token operator">:</span> <span class="token string">"MysteryTea"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"cart_infos"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">"number_of_items"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            <span class="token property">"cart_total"</span><span class="token operator">:</span> <span class="token number">39.599998474121094</span><span class="token punctuation">,</span>
            <span class="token property">"cart_footprint"</span><span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint adds a product to the cart, calculating the right coupon for the product if existing and eligible, updating the supermarket client stock adequately and returning all the infos for the cart to update it on client side.</p>
<p><strong>Be careful, it will overwrite any existing cart uuid on your user profile.</strong></p>
<h3 id="http-request-1">HTTP Request</h3>
<p><code>GET client-cart-addProductToCart</code></p>
<h3 id="query-parameters-1">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>productId</td>
<td>Int</td>
<td>The id of the product to add to cart</td>
</tr>
<tr>
<td>supermarketId</td>
<td>Int</td>
<td>The id of the supermarket the user is in buy mode in</td>
</tr>
<tr>
<td>quantity</td>
<td>Int</td>
<td>The quantity of products to add</td>
</tr>
</tbody>
</table>
<h2 id="remove-product-from-cart">Remove product from cart</h2>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> cloudFunction <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">functions</span><span class="token punctuation">(</span><span class="token string">'europe-west3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">httpsCallable</span><span class="token punctuation">(</span><span class="token string">'client-cart-removeProductFromCart'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  productId<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  supermarketId<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
  quantity<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">cloudFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"line_items"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">"quantity"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                <span class="token property">"applied_coupon"</span><span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
                <span class="token property">"carbon_footprint"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">"image_url"</span><span class="token operator">:</span> <span class="token string">"https://mysterytea-website.s3.eu-west-3.amazonaws.com/assets/2020/08/21181335/NEW-FraiseFleurieDoypack.png"</span><span class="token punctuation">,</span>
                <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Deuxième produit"</span><span class="token punctuation">,</span>
                <span class="token property">"line_value"</span><span class="token operator">:</span> <span class="token number">119.5999984741211</span><span class="token punctuation">,</span>
                <span class="token property">"selling_unit"</span><span class="token operator">:</span> <span class="token string">"2x12l"</span><span class="token punctuation">,</span>
                <span class="token property">"brand_name"</span><span class="token operator">:</span> <span class="token string">"MysteryTea"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"cart_infos"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">"number_of_items"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            <span class="token property">"cart_total"</span><span class="token operator">:</span> <span class="token number">39.599998474121094</span><span class="token punctuation">,</span>
            <span class="token property">"cart_footprint"</span><span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This endpoint removes a product from the cart, calculating the right coupon for the product if existing and eligible, updating the supermarket client stock adequately and returning all the infos for the cart to update it on client side.</p>
<p><strong>Be careful, it will overwrite any existing cart uuid on your user profile.</strong></p>
<h3 id="http-request-2">HTTP Request</h3>
<p><code>GET client-cart-removeProductFromCart</code></p>
<h3 id="query-parameters-2">Query Parameters</h3>
<table>
<thead>
<tr>
<th>Parameters</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>productId</td>
<td>Int</td>
<td>The id of the product to remove to cart</td>
</tr>
<tr>
<td>supermarketId</td>
<td>Int</td>
<td>The id of the supermarket the user is in buy mode in</td>
</tr>
<tr>
<td>quantity</td>
<td>Int</td>
<td>The quantity of products to remove</td>
</tr>
</tbody>
</table>

      </div>
      <div class="dark-box">
        
          <div class="lang-selector">
            
              
                <a href="#" data-language-name="javascript">javascript</a>
              
            
          </div>
        
      </div>
    </div>
  </body>
</html>
